{"version":3,"file":"integration.js","sources":["../../src/integration.ts"],"sourcesContent":["import { defineIntegration, hasTracingEnabled } from '@sentry/core';\nimport type { Client, IntegrationFn } from '@sentry/types';\nimport { GLOBAL_OBJ, arrayify, consoleSandbox } from '@sentry/utils';\n\nimport { DEFAULT_HOOKS } from './constants';\nimport { DEBUG_BUILD } from './debug-build';\nimport { attachErrorHandler } from './errorhandler';\nimport { createTracingMixins } from './tracing';\nimport type { Options, Vue, VueOptions } from './types';\n\nconst globalWithVue = GLOBAL_OBJ as typeof GLOBAL_OBJ & { Vue: Vue };\n\nconst DEFAULT_CONFIG: VueOptions = {\n  Vue: globalWithVue.Vue,\n  attachProps: true,\n  logErrors: true,\n  attachErrorHandler: true,\n  hooks: DEFAULT_HOOKS,\n  timeout: 2000,\n  trackComponents: false,\n};\n\nconst INTEGRATION_NAME = 'Vue';\n\nconst _vueIntegration = ((integrationOptions: Partial<VueOptions> = {}) => {\n  return {\n    name: INTEGRATION_NAME,\n    setup(client) {\n      _setupIntegration(client, integrationOptions);\n    },\n  };\n}) satisfies IntegrationFn;\n\nexport const vueIntegration = defineIntegration(_vueIntegration);\n\nfunction _setupIntegration(client: Client, integrationOptions: Partial<VueOptions>): void {\n  const options: Options = { ...DEFAULT_CONFIG, ...client.getOptions(), ...integrationOptions };\n  if (!options.Vue && !options.app) {\n    consoleSandbox(() => {\n      // eslint-disable-next-line no-console\n      console.warn(\n        `[@sentry/vue]: Misconfigured SDK. Vue specific errors will not be captured.\nUpdate your \\`Sentry.init\\` call with an appropriate config option:\n\\`app\\` (Application Instance - Vue 3) or \\`Vue\\` (Vue Constructor - Vue 2).`,\n      );\n    });\n    return;\n  }\n\n  if (options.app) {\n    const apps = arrayify(options.app);\n    apps.forEach(app => vueInit(app, options));\n  } else if (options.Vue) {\n    vueInit(options.Vue, options);\n  }\n}\n\nconst vueInit = (app: Vue, options: Options): void => {\n  if (DEBUG_BUILD) {\n    // Check app is not mounted yet - should be mounted _after_ init()!\n    // This is _somewhat_ private, but in the case that this doesn't exist we simply ignore it\n    // See: https://github.com/vuejs/core/blob/eb2a83283caa9de0a45881d860a3cbd9d0bdd279/packages/runtime-core/src/component.ts#L394\n    const appWithInstance = app as Vue & {\n      _instance?: {\n        isMounted?: boolean;\n      };\n    };\n\n    const isMounted = appWithInstance._instance && appWithInstance._instance.isMounted;\n    if (isMounted === true) {\n      consoleSandbox(() => {\n        // eslint-disable-next-line no-console\n        console.warn(\n          '[@sentry/vue]: Misconfigured SDK. Vue app is already mounted. Make sure to call `app.mount()` after `Sentry.init()`.',\n        );\n      });\n    }\n  }\n\n  if (options.attachErrorHandler) {\n    attachErrorHandler(app, options);\n  }\n\n  if (hasTracingEnabled(options)) {\n    app.mixin(\n      createTracingMixins({\n        ...options,\n        ...options.tracingOptions,\n      }),\n    );\n  }\n};\n"],"names":["GLOBAL_OBJ","DEFAULT_HOOKS","defineIntegration","consoleSandbox","arrayify","DEBUG_BUILD","attachErrorHandler","hasTracingEnabled","createTracingMixins"],"mappings":";;;;;;;;;AAUA,MAAM,aAAA,GAAgBA,gBAAW;;AAEjC,MAAM,cAAc,GAAe;AACnC,EAAE,GAAG,EAAE,aAAa,CAAC,GAAG;AACxB,EAAE,WAAW,EAAE,IAAI;AACnB,EAAE,SAAS,EAAE,IAAI;AACjB,EAAE,kBAAkB,EAAE,IAAI;AAC1B,EAAE,KAAK,EAAEC,uBAAa;AACtB,EAAE,OAAO,EAAE,IAAI;AACf,EAAE,eAAe,EAAE,KAAK;AACxB,CAAC;;AAED,MAAM,gBAAA,GAAmB,KAAK;;AAE9B,MAAM,eAAA,IAAmB,CAAC,kBAAkB,GAAwB,EAAE,KAAK;AAC3E,EAAE,OAAO;AACT,IAAI,IAAI,EAAE,gBAAgB;AAC1B,IAAI,KAAK,CAAC,MAAM,EAAE;AAClB,MAAM,iBAAiB,CAAC,MAAM,EAAE,kBAAkB,CAAC;AACnD,KAAK;AACL,GAAG;AACH,CAAC,CAAE;;MAEU,cAAe,GAAEC,sBAAiB,CAAC,eAAe;;AAE/D,SAAS,iBAAiB,CAAC,MAAM,EAAU,kBAAkB,EAA6B;AAC1F,EAAE,MAAM,OAAO,GAAY,EAAE,GAAG,cAAc,EAAE,GAAG,MAAM,CAAC,UAAU,EAAE,EAAE,GAAG,oBAAoB;AAC/F,EAAE,IAAI,CAAC,OAAO,CAAC,GAAI,IAAG,CAAC,OAAO,CAAC,GAAG,EAAE;AACpC,IAAIC,oBAAc,CAAC,MAAM;AACzB;AACA,MAAM,OAAO,CAAC,IAAI;AAClB,QAAQ,CAAC;AACT;AACA,4EAA4E,CAAC;AAC7E,OAAO;AACP,KAAK,CAAC;AACN,IAAI;AACJ;;AAEA,EAAE,IAAI,OAAO,CAAC,GAAG,EAAE;AACnB,IAAI,MAAM,OAAOC,cAAQ,CAAC,OAAO,CAAC,GAAG,CAAC;AACtC,IAAI,IAAI,CAAC,OAAO,CAAC,GAAI,IAAG,OAAO,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC;AAC9C,SAAS,IAAI,OAAO,CAAC,GAAG,EAAE;AAC1B,IAAI,OAAO,CAAC,OAAO,CAAC,GAAG,EAAE,OAAO,CAAC;AACjC;AACA;;AAEA,MAAM,UAAU,CAAC,GAAG,EAAO,OAAO,KAAoB;AACtD,EAAE,IAAIC,sBAAW,EAAE;AACnB;AACA;AACA;AACA,IAAI,MAAM,eAAgB,GAAE;;AAIxB;;AAEJ,IAAI,MAAM,SAAU,GAAE,eAAe,CAAC,SAAU,IAAG,eAAe,CAAC,SAAS,CAAC,SAAS;AACtF,IAAI,IAAI,SAAU,KAAI,IAAI,EAAE;AAC5B,MAAMF,oBAAc,CAAC,MAAM;AAC3B;AACA,QAAQ,OAAO,CAAC,IAAI;AACpB,UAAU,sHAAsH;AAChI,SAAS;AACT,OAAO,CAAC;AACR;AACA;;AAEA,EAAE,IAAI,OAAO,CAAC,kBAAkB,EAAE;AAClC,IAAIG,+BAAkB,CAAC,GAAG,EAAE,OAAO,CAAC;AACpC;;AAEA,EAAE,IAAIC,sBAAiB,CAAC,OAAO,CAAC,EAAE;AAClC,IAAI,GAAG,CAAC,KAAK;AACb,MAAMC,2BAAmB,CAAC;AAC1B,QAAQ,GAAG,OAAO;AAClB,QAAQ,GAAG,OAAO,CAAC,cAAc;AACjC,OAAO,CAAC;AACR,KAAK;AACL;AACA,CAAC;;;;"}